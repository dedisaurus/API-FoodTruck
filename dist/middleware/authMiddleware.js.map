{"version":3,"sources":["../../src/middleware/authMiddleware.js"],"names":["TOKENTIME","SECRET","authenticate","secret","generateAccessToken","req","res","next","token","jwt","sign","id","user","expiresIn","respond","status","json","username","module","exports"],"mappings":";;AAAA;;;;AACA;;;;;;AAEA,IAAMA,YAAY,KAAG,EAAH,GAAM,EAAN,GAAS,EAA3B,C,CAA+B;AAC/B,IAAMC,SAAS,kBAAf;;AAEA,IAAIC,eAAe,0BAAW,EAAEC,QAAQF,MAAV,EAAX,CAAnB;AACA,IAAIG,sBAAsB,SAAtBA,mBAAsB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAmB;AACzCF,QAAIG,KAAJ,GAAWH,IAAIG,KAAJ,IAAY,EAAvB;AACAH,QAAIG,KAAJ,GAAYC,uBAAIC,IAAJ,CAAS;AACjBC,YAAGN,IAAIO,IAAJ,CAASD;AADK,KAAT,EAETV,MAFS,EAED;AACPY,mBAAWb,SADJ,CACc;AADd,KAFC,CAAZ;AAKAO;AACH,CARD;;AAUA,IAAIO,UAAU,SAAVA,OAAU,CAACT,GAAD,EAAMC,GAAN,EAAa;AACvBA,QAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBJ,cAAOP,IAAIO,IAAJ,CAASK,QADC;AAEjBT,eAAOH,IAAIG;AAFM,KAArB;AAIH,CALD;;AAOAU,OAAOC,OAAP,GAAiB;AACbjB,8BADa,EACCE,wCADD,EACsBU;AADtB,CAAjB","file":"authMiddleware.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport expressJwt from 'express-jwt';\r\n\r\nconst TOKENTIME = 60*60*24*30; // 30 days\r\nconst SECRET = \"w3 Hav3 th3 kn0w\";\r\n\r\nlet authenticate = expressJwt({ secret: SECRET});\r\nlet generateAccessToken = (req, res, next) =>{\r\n    req.token= req.token ||{};\r\n    req.token = jwt.sign({\r\n        id:req.user.id,\r\n    }, SECRET, {\r\n        expiresIn: TOKENTIME //30days\r\n    } );\r\n    next();\r\n};\r\n\r\nlet respond = (req, res) =>{\r\n    res.status(200).json({\r\n        user : req.user.username,\r\n        token: req.token\r\n    });\r\n};\r\n\r\nmodule.exports = {\r\n    authenticate, generateAccessToken, respond\r\n};"]}